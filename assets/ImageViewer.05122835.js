import{_ as e}from"./ContentWrap.81130664.js";import{bZ as a,E as t,F as s,b9 as n,aJ as i,d as o,cg as l,ch as u,ci as r,R as c,bP as d,r as f,cj as m,aY as p,H as v,v as g,M as b,C as k,o as w,k as h,g as x,w as y,e as I,n as _,a as C,as as O,Y as z,P as j,a$ as T,c as L,b3 as N,aP as A,$ as D,ck as E,cl as M,Z as V,cm as X,cn as Y,a9 as B,aG as R,aX as $,a0 as F,z as P,h as S,bQ as W,_ as G,bh as Z,G as H,co as J,a1 as Q,a7 as q,X as K,cp as U,cb as ee,l as ae,y as te,t as se}from"./index.c89981a6.js";import{i as ne}from"./browser.f8fe7a4c.js";import{u as ie}from"./index.fc556847.js";import{d as oe}from"./debounce.959d57d3.js";import{E as le}from"./el-button.9191f867.js";import"./el-card.377296af.js";import"./el-popper.bf812a74.js";import"./index.ae55fe18.js";import"./index.68586847.js";function ue(e,t,s){var n=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return a(s)&&(n="leading"in s?!!s.leading:n,i="trailing"in s?!!s.trailing:i),oe(e,t,{leading:n,maxWait:t,trailing:i})}const re=t({urlList:{type:s(Array),default:()=>n([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0}}),ce=["src"];const de=Q(G(o({name:"ElImageViewer",props:re,emits:{close:()=>!0,switch:e=>i(e)},setup(e,{emit:a}){const t=e,s={CONTAIN:{name:"contain",icon:l(u)},ORIGINAL:{name:"original",icon:l(r)}},n=ne()?"DOMMouseScroll":"mousewheel",{t:o}=ie(),G=c("image-viewer"),{nextZIndex:Q}=d(),q=f(),K=f([]),U=m(),ee=f(!0),ae=f(t.initialIndex),te=p(s.CONTAIN),se=f({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),oe=v((()=>{const{urlList:e}=t;return e.length<=1})),le=v((()=>0===ae.value)),re=v((()=>ae.value===t.urlList.length-1)),de=v((()=>t.urlList[ae.value])),fe=v((()=>{const{scale:e,deg:a,offsetX:t,offsetY:n,enableTransition:i}=se.value;let o=t/e,l=n/e;switch(a%360){case 90:case-270:[o,l]=[l,-o];break;case 180:case-180:[o,l]=[-o,-l];break;case 270:case-90:[o,l]=[-l,o]}const u={transform:`scale(${e}) rotate(${a}deg) translate(${o}px, ${l}px)`,transition:i?"transform .3s":""};return te.value.name===s.CONTAIN.name&&(u.maxWidth=u.maxHeight="100%"),u})),me=v((()=>i(t.zIndex)?t.zIndex:Q()));function pe(){U.stop(),a("close")}function ve(){ee.value=!1}function ge(e){ee.value=!1,e.target.alt=o("el.image.error")}function be(e){if(ee.value||0!==e.button||!q.value)return;se.value.enableTransition=!1;const{offsetX:a,offsetY:t}=se.value,s=e.pageX,n=e.pageY,i=ue((e=>{se.value={...se.value,offsetX:a+e.pageX-s,offsetY:t+e.pageY-n}})),o=Z(document,"mousemove",i);Z(document,"mouseup",(()=>{o()})),e.preventDefault()}function ke(){se.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function we(){if(ee.value)return;const e=J(s),a=Object.values(s),t=te.value.name,n=(a.findIndex((e=>e.name===t))+1)%e.length;te.value=s[e[n]],ke()}function he(){if(le.value&&!t.infinite)return;const e=t.urlList.length;ae.value=(ae.value-1+e)%e}function xe(){if(re.value&&!t.infinite)return;const e=t.urlList.length;ae.value=(ae.value+1)%e}function ye(e,a={}){if(ee.value)return;const{zoomRate:t,rotateDeg:s,enableTransition:n}={zoomRate:1.4,rotateDeg:90,enableTransition:!0,...a};switch(e){case"zoomOut":se.value.scale>.2&&(se.value.scale=Number.parseFloat((se.value.scale/t).toFixed(3)));break;case"zoomIn":se.value.scale<7&&(se.value.scale=Number.parseFloat((se.value.scale*t).toFixed(3)));break;case"clockwise":se.value.deg+=s;break;case"anticlockwise":se.value.deg-=s}se.value.enableTransition=n}return g(de,(()=>{b((()=>{const e=K.value[0];(null==e?void 0:e.complete)||(ee.value=!0)}))})),g(ae,(e=>{ke(),a("switch",e)})),k((()=>{var e,a;!function(){const e=ue((e=>{switch(e.code){case H.esc:t.closeOnPressEscape&&pe();break;case H.space:we();break;case H.left:he();break;case H.up:ye("zoomIn");break;case H.right:xe();break;case H.down:ye("zoomOut")}})),a=ue((e=>{ye((e.wheelDelta?e.wheelDelta:-e.detail)>0?"zoomIn":"zoomOut",{zoomRate:1.2,enableTransition:!1})}));U.run((()=>{Z(document,"keydown",e),Z(document,n,a)}))}(),null==(a=null==(e=q.value)?void 0:e.focus)||a.call(e)})),(e,a)=>(w(),h(W,{to:"body",disabled:!e.teleported},[x(S,{name:"viewer-fade",appear:""},{default:y((()=>[I("div",{ref_key:"wrapper",ref:q,tabindex:-1,class:_(C(G).e("wrapper")),style:F({zIndex:C(me)})},[I("div",{class:_(C(G).e("mask")),onClick:a[0]||(a[0]=O((a=>e.hideOnClickModal&&pe()),["self"]))},null,2),z(" CLOSE "),I("span",{class:_([C(G).e("btn"),C(G).e("close")]),onClick:pe},[x(C(j),null,{default:y((()=>[x(C(T))])),_:1})],2),z(" ARROW "),C(oe)?z("v-if",!0):(w(),L(D,{key:0},[I("span",{class:_([C(G).e("btn"),C(G).e("prev"),C(G).is("disabled",!e.infinite&&C(le))]),onClick:he},[x(C(j),null,{default:y((()=>[x(C(N))])),_:1})],2),I("span",{class:_([C(G).e("btn"),C(G).e("next"),C(G).is("disabled",!e.infinite&&C(re))]),onClick:xe},[x(C(j),null,{default:y((()=>[x(C(A))])),_:1})],2)],64)),z(" ACTIONS "),I("div",{class:_([C(G).e("btn"),C(G).e("actions")])},[I("div",{class:_(C(G).e("actions__inner"))},[x(C(j),{onClick:a[1]||(a[1]=e=>ye("zoomOut"))},{default:y((()=>[x(C(E))])),_:1}),x(C(j),{onClick:a[2]||(a[2]=e=>ye("zoomIn"))},{default:y((()=>[x(C(M))])),_:1}),I("i",{class:_(C(G).e("actions__divider"))},null,2),x(C(j),{onClick:we},{default:y((()=>[(w(),h(V(C(te).icon)))])),_:1}),I("i",{class:_(C(G).e("actions__divider"))},null,2),x(C(j),{onClick:a[3]||(a[3]=e=>ye("anticlockwise"))},{default:y((()=>[x(C(X))])),_:1}),x(C(j),{onClick:a[4]||(a[4]=e=>ye("clockwise"))},{default:y((()=>[x(C(Y))])),_:1})],2)],2),z(" CANVAS "),I("div",{class:_(C(G).e("canvas"))},[(w(!0),L(D,null,B(e.urlList,((e,a)=>R((w(),L("img",{ref_for:!0,ref:e=>K.value[a]=e,key:e,src:e,style:F(C(fe)),class:_(C(G).e("img")),onLoad:ve,onError:ge,onMousedown:be},null,46,ce)),[[$,a===ae.value]]))),128))],2),P(e.$slots,"default")],6)])),_:3})],8,["disabled"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]));const fe=o({__name:"ImageViewer",props:{urlList:{type:Array,default:()=>[]},zIndex:q.number.def(200),initialIndex:q.number.def(0),infinite:q.bool.def(!0),hideOnClickModal:q.bool.def(!1),appendToBody:q.bool.def(!1),show:q.bool.def(!1)},setup(e){const a=e,t=v((()=>{const e={...a};return delete e.show,e})),s=f(a.show),n=()=>{s.value=!1};return(e,a)=>s.value?(w(),h(C(de),K({key:0},C(t),{onClose:n}),null,16)):z("v-if",!0)}});let me=null;const pe=o({__name:"ImageViewer",setup(a){const{t:t}=ae(),s=()=>{!function(e){if(!U)return;const{urlList:a,initialIndex:t=0,infinite:s=!0,hideOnClickModal:n=!1,appendToBody:i=!1,zIndex:o=2e3,show:l=!0}=e,u={},r=document.createElement("div");u.urlList=a,u.initialIndex=t,u.infinite=s,u.hideOnClickModal=n,u.appendToBody=i,u.zIndex=o,u.show=l,document.body.appendChild(r),me=x(fe,u),ee(me,r)}({urlList:["https://img1.baidu.com/it/u=657828739,1486746195&fm=26&fmt=auto&gp=0.jpg","https://img0.baidu.com/it/u=3114228356,677481409&fm=26&fmt=auto&gp=0.jpg","https://img1.baidu.com/it/u=508846955,3814747122&fm=26&fmt=auto&gp=0.jpg","https://img1.baidu.com/it/u=3536647690,3616605490&fm=26&fmt=auto&gp=0.jpg","https://img1.baidu.com/it/u=4087287201,1148061266&fm=26&fmt=auto&gp=0.jpg","https://img2.baidu.com/it/u=3429163260,2974496379&fm=26&fmt=auto&gp=0.jpg"]})};return(a,n)=>(w(),h(C(e),{title:C(t)("imageViewerDemo.imageViewer"),message:C(t)("imageViewerDemo.imageViewerDes")},{default:y((()=>[x(C(le),{type:"primary",onClick:s},{default:y((()=>[te(se(C(t)("imageViewerDemo.open")),1)])),_:1})])),_:1},8,["title","message"]))}});export{pe as default};
