import{F as e}from"./Form.92ef4b20.js";import{d as o,b as a,m as s,u as r,q as t,l as i,s as l,r as n,v as c,x as d,o as p,k as m,w as u,e as f,t as g,a as w,g as b,y as j}from"./index.976d50ce.js";import{E as v}from"./el-button.c8459927.js";import{E as h}from"./tsxHelper.4ba93dcc.js";import{E as x}from"./el-link.6f4e818f.js";import{u as y}from"./useForm.cb9836af.js";import{l as P,g as R,a as _}from"./index.82595098.js";import{u as I}from"./useValidator.9359a8d0.js";import{_ as k}from"./plugin-vue_export-helper.21dcd24c.js";import"./el-col.165da7c3.js";import"./el-popper.8324f673.js";import"./index.caa1c62b.js";import"./el-input.37bc8bcd.js";import"./event.fa25aaef.js";import"./index.95ab9e3a.js";import"./el-tag.645861df.js";import"./el-input-number.348397c8.js";import"./index.8a7d4f28.js";import"./el-switch.edd93c60.js";import"./validator.467ff7cf.js";import"./el-divider.0d268fa1.js";import"./InputPassword.c0e7e760.js";import"./Editor.bc5101ac.js";import"./debounce.04b5c6f2.js";import"./aria.1f702b5f.js";import"./scroll.674261f8.js";import"./browser.19fcc186.js";const F={class:"text-2xl font-bold text-center w-[100%]"},z={class:"flex justify-between items-center w-[100%]"},E={class:"w-[100%]"},q={class:"w-[100%] mt-15px"},C={class:"flex justify-between w-[100%]"};var V=k(o({__name:"LoginForm",emits:["to-register"],setup(o,{emit:k}){const{required:V}=I(),D=a(),A=s(),{currentRoute:L,addRoute:U,push:H}=r(),{wsCache:N}=t(),{t:B}=i(),G={username:[V()],password:[V()]},J=l([{field:"title",colProps:{span:24}},{field:"username",label:B("login.username"),value:"admin",component:"Input",colProps:{span:24},componentProps:{placeholder:B("login.usernamePlaceholder")}},{field:"password",label:B("login.password"),value:"admin",component:"InputPassword",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:B("login.passwordPlaceholder")}},{field:"tool",colProps:{span:24}},{field:"login",colProps:{span:24}},{field:"other",component:"Divider",label:B("login.otherLogin"),componentProps:{contentPosition:"center"}},{field:"otherIcon",colProps:{span:24}}]),K=n(!1),{register:M,elFormRef:O,methods:Q}=y(),S=n(!1),T="#999",W=n("");c((()=>L.value),(e=>{var o;W.value=null==(o=null==e?void 0:e.query)?void 0:o.redirect}),{immediate:!0});const X=async()=>{const e=w(O);await(null==e?void 0:e.validate((async e=>{if(e){S.value=!0;const{getFormData:e}=Q,o=await e();try{const e=await P(o);e&&(N.set(D.getUserInfo,e.data),Y())}finally{S.value=!1}}})))},Y=async()=>{const{getFormData:e}=Q,o=await e(),a={roleName:o.username},s="admin"===o.username?await R(a):await _(a);if(s){const{wsCache:e}=t(),a=s.data||[];e.set("roleRouters",a),"admin"===o.username?await A.generateRoutes("admin",a).catch((()=>{})):await A.generateRoutes("test",a).catch((()=>{})),A.getAddRouters.forEach((e=>{U(e)})),A.setIsAddRouters(!0),H({path:W.value||A.addRouters[0].path})}},Z=()=>{k("to-register")};return(o,a)=>{const s=d("Icon");return p(),m(w(e),{schema:J,rules:G,"label-position":"top","hide-required-asterisk":"",size:"large",class:"dark:border-1 dark:border-[var(--el-border-color)] dark:border-solid",onRegister:w(M)},{title:u((()=>[f("h2",F,g(w(B)("login.login")),1)])),tool:u((()=>[f("div",z,[b(w(h),{modelValue:K.value,"onUpdate:modelValue":a[0]||(a[0]=e=>K.value=e),label:w(B)("login.remember"),size:"small"},null,8,["modelValue","label"]),b(w(x),{type:"primary",underline:!1},{default:u((()=>[j(g(w(B)("login.forgetPassword")),1)])),_:1})])])),login:u((()=>[f("div",E,[b(w(v),{loading:S.value,type:"primary",class:"w-[100%]",onClick:X},{default:u((()=>[j(g(w(B)("login.login")),1)])),_:1},8,["loading"])]),f("div",q,[b(w(v),{class:"w-[100%]",onClick:Z},{default:u((()=>[j(g(w(B)("login.register")),1)])),_:1})])])),otherIcon:u((()=>[f("div",C,[b(s,{icon:"ant-design:github-filled",size:30,class:"cursor-pointer anticon",color:T}),b(s,{icon:"ant-design:wechat-filled",size:30,class:"cursor-pointer anticon",color:T}),b(s,{icon:"ant-design:alipay-circle-filled",size:30,color:T,class:"cursor-pointer anticon"}),b(s,{icon:"ant-design:weibo-circle-filled",size:30,color:T,class:"cursor-pointer anticon"})])])),_:1},8,["schema","onRegister"])}}}),[["__scopeId","data-v-516888a6"]]);export{V as default};
